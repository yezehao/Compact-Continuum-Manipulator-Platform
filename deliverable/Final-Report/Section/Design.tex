%%%%% Design %%%%%
\section{Design} 
This is the Design of the final report.
\subsection{Methodology}
\subsubsection{Forward Kinematics}
The manipulator consists of four sections, and the backbones of each section are perpendicular to each other. To derive the 
workspace of the manipulator for further analysis, the forward kinematics formula need to be conducted. According to the 
fishbone continuum robot\cite{fishboneCR}, the forward kinematics formula of two perpendicular sections are shown in 
Equations \ref{eq:x_coordinate}, \ref{eq:y_coordinate}, and \ref{eq:z_coordinate}.
\begin{align}
    \begin{aligned}
    x=&-\frac{S_{r}r}{\Delta S_{1}}+\frac{S_{r}r}{\Delta S_{1}}\cos\left(\frac{\Delta S_{l}}{r}\right)-d_{1}\sin\left(\frac{\Delta S_{l}}{r}\right) \\
    &-\frac{S_{r}r}{\Delta S_{3}}\sin\left(\frac{\Delta S_{1}}{r}\right)\sin\left(\frac{\Delta S_{3}}{r}\right) \\
    &-d_{2}\sin\left(\frac{\Delta S_{1}}{r}\right)\cos\left(\frac{\Delta S_{3}}{r}\right) 
    \end{aligned}
    \label{eq:x_coordinate}
\end{align}
\begin{align}
    \begin{aligned}
        y=-\frac{S_rr}{\Delta S_3}+\frac{S_rr}{\Delta S_3}\cos\left(\frac{\Delta S_3}{r}\right)-d_2\sin\left(\frac{\Delta S_3}{r}\right)
    \end{aligned}
    \label{eq:y_coordinate}
\end{align}
\begin{align}
    \begin{aligned}
        \text{Z} =&\frac{S_{r}r}{\Delta S_{1}}\sin\left(\frac{\Delta S_{\mathrm{l}}}{r}\right)+d_{1}\cos\left(\frac{\Delta S_{\mathrm{l}}}{r}\right) \\
        +&\frac{S_{r}r}{\Delta S_{3}}\sin\left(\frac{\Delta S_{3}}{r}\right)\cos\left(\frac{\Delta S_{1}}{r}\right) \\
        +&d_{2}\cos\left(\frac{\Delta S_{1}}{r}\right)\cos\left(\frac{\Delta S_{3}}{r}\right). 
    \end{aligned}
    \label{eq:z_coordinate}
\end{align}
However, calculating the centroid directly using the above formula becomes complex while there are four units in the manipulator. 
Additionally, the inverse kinematics part also requires the derivation of corresponding matrices for subsequent calculations 
using the composite coordinate transformation formula. Therefore, The relevant matrices for subsequent calculations need to 
be derived. 
The position of the end effector at the section whose backbone is parallel to the x-axis, which is $\textbf{P}_{end}$ can be 
derived based on the bending angle matrix $\textbf{B}$, mechanism parameters, the position of the end effector in the base 
coordinate system $\textbf{P}_{base}^{end}$ and the position of the base at the section $\textbf{P}_{base}$. The composite 
coordinate transformation is a combination of rotation and translation. The equations are shown in Equations \ref{eq:composite} 
and \ref{eq:composite_matrices}. $P_{horizontal}$ and $P_{vertical}$ are the horizontal and vertical position of end effector 
at the section in the base coordinate system, respectively. The sign of $P_{horizontal}$ in matrix $\textbf{P}_{base}^{end}$ 
consistent with the the sign of $\alpha$.
\begin{align}
    \textbf{P}_{end} = \textbf{B} \times \textbf{P}_{base} &+ \textbf{P}_{base}^{end} \label{eq:composite} \\
    \begin{bmatrix}
        x' \\
        y' \\
        z' \\
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 & 0 & 0 \\
        0 & \cos(\alpha) & \sin(\alpha) \\
        0 & -\sin(\alpha) & \cos(\alpha) \\
    \end{bmatrix}
    &\times
    \begin{bmatrix}
        x \\
        y \\
        z \\
    \end{bmatrix}
    +
    \begin{bmatrix}
        0 \\
        \pm P_{\text{horizontal}} \\
        P_{\text{vertical}} \\
    \end{bmatrix}\label{eq:composite_matrices} \\
    P_{horizontal} = R\cdot(1-cos&(\alpha) + d\cdot cos(\alpha)) \nonumber \\ 
    P_{vertical} = R\cdot sin(\alpha) + &d\cdot sin(\alpha) \nonumber
\end{align}
The composite transfermation matrix of the first section whose backbone is parallel to x-axis is derived in Equations 
\ref{eq:CTMS1} and \ref{eq:composite_transf_matrix_section1}.
\begin{align}
    &\qquad\qquad
    \begin{aligned}
    \textbf{P}_{end,1}
    =
    \begin{bmatrix}
        \textbf{B}_1 & \textbf{P}_{base,1}^{end} \\
        \textbf{0} & 1 \\
    \end{bmatrix}
    \textbf{P}_{base,1}
    \end{aligned}\label{eq:CTMS1}\\
    &\begin{aligned}
    \begin{bmatrix}
        x' \\
        y' \\
        z' \\
        1  \\
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 & 0 & 0 & 0 \\
        0 & cos(\alpha1) & sin(\alpha1) & \pm P_{horizontal,1} \\
        0 & -sin(\alpha1) & cos(\alpha1) & P_{vertical,1} \\
        0 & 0 & 0 & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
        x \\
        y \\
        z \\
        1 \\
    \end{bmatrix}
    \end{aligned}
    \label{eq:composite_transf_matrix_section1}
\end{align}
The composite transfermation matrix of the second section whose backbone is parallel to y-axis is derived in Equations 
\ref{eq:CTMS2} and \ref{eq:composite_transf_matrix_section2}. ($\textbf{P}_{base,2}$ is equivalent to $\textbf{P}_{end,1}$)
\begin{align}
    &\qquad\qquad
    \begin{aligned}
    \textbf{P}_{end,2}
    =
    \begin{bmatrix}
        \textbf{B}_2 & \textbf{P}_{base,2}^{end} \\
        \textbf{0} & 1 \\
    \end{bmatrix}
    \textbf{P}_{base,2}
    \text{ ($\textbf{P}_{end,1}$)}
    \end{aligned}\label{eq:CTMS2}\\
    &\begin{aligned}
    \begin{bmatrix}
        x' \\
        y' \\
        z' \\
        1  \\
    \end{bmatrix}
    =
    \begin{bmatrix}
        cos(\alpha2) & 0 & sin(\alpha2) & \pm P_{horizontal,2} \\
        0 & 1 & 0 & 0 \\
        -sin(\alpha2) & 0 & cos(\alpha2) & P_{vertical,2} \\
        0 & 0 & 0 & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
        x \\
        y \\
        z \\
        1 \\
    \end{bmatrix}
    \end{aligned}
    \label{eq:composite_transf_matrix_section2}
\end{align}
The manipulator consists of four sections. Therefore, the coordinates of the base and end effector of the manipulator can 
be expressed through the following forward kinematics matrices in Equation \ref{eq:FMplus4}.
\begin{align}
    \textbf{P}_{end,4}
    =
    \begin{bmatrix}
        \textbf{B}_4 & \textbf{P}_{base,4}^{end} \\
        \textbf{0} & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
        \textbf{B}_3 & \textbf{P}_{base,3}^{end} \\
        \textbf{0} & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
        \textbf{B}_2 & \textbf{P}_{base,2}^{end} \\
        \textbf{0} & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
        \textbf{B}_1 & \textbf{P}_{base,1}^{end} \\
        \textbf{0} & 1 \\
    \end{bmatrix}
    \textbf{P}_{base,1}
    \label{eq:FMplus4}
\end{align}

\subsection{part ??}
unknown
\subsection{part ??}
unknown

% change to new page
\newpage